# Архитектура проекта myZemax

## Обзор

Проект построен на основе стандарта интерфейса `dr4hui-interface`, который предоставляет:
- `dr4` - абстракция для графического бэкенда (окна, текстуры, события)
- `hui` - система виджетов для создания GUI
- `cum` - система плагинов
- `pp` - интерфейс для плагинов дорисовки

## Структура компонентов

### Ray Tracing Engine (`include/raytracer/`)

- **vec3.hpp** - 3D векторная математика
- **ray.hpp** - Луч для трассировки
- **object.hpp** - Базовый класс для всех объектов
- **objects.hpp** - Конкретные типы объектов:
  - `Sphere` - сфера
  - `Plane` - плоскость
  - `Disk` - диск
  - `Prism` - прямоугольная призма
  - `Pyramid` - пирамида (тетраэдр)
- **camera.hpp** - Камера с управлением
- **scene.hpp** - Сцена с коллекцией объектов
- **raytracer.hpp** - Движок ray tracing

### UI Components (`include/ui/`)

- **application.hpp** - Главный класс приложения
- **main_window.hpp** - Главное окно, контейнер для всех панелей
- **raytracer_window.hpp** - Окно визуализации ray tracing
- **control_panel.hpp** - Панель управления камерой
- **objects_panel.hpp** - Панель списка объектов
- **properties_window.hpp** - Окно редактирования свойств
- **toolbar.hpp** - Панель инструментов с меню плагинов

## Поток данных

1. **События** → `Application::ProcessEvents()` → `UI::ProcessEvent()` → Виджеты
2. **Обновление** → `Application::Update()` → `IdleEvent` → Виджеты
3. **Рендеринг** → `Application::Render()` → `UI::GetTexture()` → Окно

## Управление камерой

Камера управляется через:
- Клавиатуру (WASD + стрелки) - обрабатывается в `ControlPanel`
- Кнопки в Control Panel (будущая реализация)

Камера поддерживает плавное ускорение при удержании клавиш.

## Выбор объектов

Объекты можно выбрать двумя способами:
1. Клик мышкой в ray tracer окне
2. Клик по объекту в списке объектов

При выборе:
- Объект подсвечивается в списке
- Вокруг объекта появляется рамка в ray tracer
- Открывается окно свойств для редактирования

## Плагины

Структура для плагинов готова:
- **DR4BackendPlugin** - плагин графического бэкенда (например, SFML)
- **PPToolPlugin** - плагин инструментов дорисовки

Плагины загружаются через `cum::Manager` и доступны через toolbar.

## Будущие улучшения

- Копирование/вставка объектов
- Улучшенная визуализация (правильная проекция 3D на 2D)
- Более сложный ray tracing (рефракция, отражение)
- Сохранение/загрузка сцен
- Дополнительные типы объектов





